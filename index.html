<!DOCTYPE html>
<html>
<head>
    <title>Boxing Event Incentive Drivers</title>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs"></script>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs-backend-webgl"></script>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow-models/body-segmentation"></script>
</head>
<body>
    <div style="text-align: center;">
        <h1>Incentive Drivers for Boxing Events</h1>
        <canvas id="canvas" width="300" height="300"></canvas>
        <video id="webcam" autoplay width="640" height="480"></video>
    </div>

    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        const webcamElement = document.getElementById('webcam');
        let segmenter;

        const drivers = [
            { text: "Pay-Per-View Revenue", value: "$$$" },
            { text: "Sponsorship Deals", value: "$$" },
            { text: "Ticket Sales", value: "$" },
            { text: "High-Profile Matchups", value: "🥊" },
            { text: "International Exposure", value: "🌍" },
            { text: "Media Coverage", value: "📰" }
        ];

        let highlightedIndex = 0;

        function drawDrivers() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            ctx.font = '16px Arial';
            ctx.fillStyle = 'black';
            ctx.fillText("Incentive Drivers", 100, 30);
            ctx.beginPath();
            ctx.moveTo(50, 40);
            ctx.lineTo(250, 40);
            ctx.stroke();

            let y = 70;
            drivers.forEach((driver, index) => {
                if (index === highlightedIndex) {
                    ctx.fillStyle = 'blue';
                } else {
                    ctx.fillStyle = 'black';
                }
                ctx.fillText("- " + driver.text, 60, y);
                ctx.fillText(driver.value, 220, y);
                y += 30;
            });

            highlightedIndex = (highlightedIndex + 1) % drivers.length;
        }

        async function initializeSegmenter() {
            const model = bodySegmentation.SupportedModels.MediaPipeSelfieSegmentation;
            const segmenterConfig = {
                runtime: 'mediapipe',
                modelType: 'general'
            };
            segmenter = await bodySegmentation.createSegmenter(model, segmenterConfig);
        }

        async function predict() {
            drawDrivers();

            if (segmenter) {
                const people = await segmenter.segmentPeople(webcamElement);
                const foregroundColor = { r: 0, g: 0, b: 0, a: 0 };
                const backgroundColor = { r: 0, g: 0, b: 0, a: 127 };
                const drawContour = true;
                const foregroundThreshold = 0.6;

                const segmentationMask = await bodySegmentation.toBinaryMask(people, foregroundColor, backgroundColor, drawContour, foregroundThreshold);
                ctx.drawImage(webcamElement, 0, 0, canvas.width, canvas.height);
                ctx.drawImage(segmentationMask, 0, 0, canvas.width, canvas.height);
            }

            requestAnimationFrame(predict);
        }

        async function setupWebcam() {
            const stream = await navigator.mediaDevices.getUserMedia({ 'video': true });
            webcamElement.srcObject = stream;
            return new Promise((resolve) => {
                webcamElement.onloadedmetadata = () => {
                    resolve(webcamElement);
                };
            });
        }

        async function bindPage() {
            await initializeSegmenter();
            await setupWebcam();
            predict();
        }

        window.onload = bindPage;

    </script>
</body>
</html>

<!DOCTYPE html>
<html>
<head>
    <title>Face Detection with Webcam</title>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/face_detection"></script>
</head>
<body>
    <div style="text-align: center;">
        <h1>Face Detection with Webcam</h1>
        <video id="webcam" autoplay playsinline></video>
        <canvas id="canvas" width="640" height="480"></canvas>
    </div>

    <script>
        async function setupCamera() {
            const video = document.getElementById('webcam');

            const stream = await navigator.mediaDevices.getUserMedia({ 'video': true });
            video.srcObject = stream;

            return new Promise((resolve) => {
                video.onloadedmetadata = () => {
                    resolve(video);
                };
            });
        }

        async function detectFaces() {
            const video = await setupCamera();
            video.play();

            const canvas = document.getElementById('canvas');
            const ctx = canvas.getContext('2d');

            const faceDetector = new faceDetection.FaceDetector({
                modelUrl: faceDetection.SupportedModels.MediaPipeFaceDetector
            });

            async function renderPrediction() {
                const faces = await faceDetector.estimateFaces(video);

                ctx.clearRect(0, 0, canvas.width, canvas.height);
                ctx.drawImage(video, 0, 0, canvas.width, canvas.height);

                faces.forEach(face => {
                    const boundingBox = face.boundingBox;
                    ctx.strokeStyle = '#00FF00';
                    ctx.lineWidth = 2;
                    ctx.strokeRect(boundingBox.x, boundingBox.y, boundingBox.width, boundingBox.height);
                });

                requestAnimationFrame(renderPrediction);
            }

            renderPrediction();
        }

        detectFaces();
    </script>
</body>
</html>
